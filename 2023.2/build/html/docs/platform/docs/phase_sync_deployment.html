<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
<!-- OneTrust Cookies Consent Notice start for xilinx.github.io -->

<script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" data-document-language="true" type="text/javascript" charset="UTF-8" data-domain-script="03af8d57-0a04-47a6-8f10-322fa00d8fc7" ></script>
<script type="text/javascript">
function OptanonWrapper() { }
</script>
<!-- OneTrust Cookies Consent Notice end for xilinx.github.io -->
  <title>IEEE 1588 PTP Phase synchronization Platform &mdash; VCK190 Ethernet TRD 2022.1 documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/_static/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../_static/documentation_options.js?v=2406f4f9"></script>
        <script src="../../../_static/doctools.js?v=888ff710"></script>
        <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Steps to Build the TRD Package for VMK180 Board" href="vmk_180_porting.html" />
    <link rel="prev" title="Revision History" href="revision_history.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
            <a href="../../../index.html" class="icon icon-home"> VCK190 Ethernet TRD
          </a>
              <div class="version">
                2.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../platform_landing.html">MRMAC Ethernet TRD</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../platform_landing.html#features">Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="../platform_landing.html#quick-start">Quick Start</a></li>
<li class="toctree-l2"><a class="reference internal" href="../platform_landing.html#tutorials">Tutorials</a></li>
<li class="toctree-l2"><a class="reference internal" href="../platform_landing.html#architecture-documents">Architecture Documents</a></li>
<li class="toctree-l2"><a class="reference internal" href="../platform_landing.html#others">Others</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../platform_landing.html#ptp-1588-phase-synchronization-2022-2-phase-sync-trd">PTP 1588 Phase Synchronization (2022.2 Phase sync TRD)</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">IEEE 1588 PTP Phase synchronization Platform</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#features"><strong>Features</strong></a></li>
<li class="toctree-l4"><a class="reference internal" href="#setup-tested"><strong>Setup Tested</strong></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ptp-commands">PTP commands</a></li>
<li class="toctree-l4"><a class="reference internal" href="#accessing-the-tutorial-reference-files">Accessing the Tutorial Reference Files</a></li>
<li class="toctree-l4"><a class="reference internal" href="#trd-package-file-structure">TRD package File Structure:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#to-build-the-trd-package-with-the-top-makefile">To Build the TRD Package with the top Makefile:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#to-build-the-hardware-platform-xsa">To Build the Hardware Platform XSA:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#to-build-the-petalinux-images">To Build the Petalinux Images:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#license">License</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../platform_landing.html#porting-the-trd-package-to-vmk180-board">Porting the TRD package to VMK180 Board</a></li>
<li class="toctree-l2"><a class="reference internal" href="../platform_landing.html#xilinx-support">Xilinx Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../platform_landing.html#license">License</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Versions</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/vck190-ethernet-trd/2023.2/build/html/index.html">Master (2023.2)</a></li>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/vck190-ethernet-trd/2023.1/build/html/index.html">2023.1</a></li>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/vck190-ethernet-trd/2022.2/build/html/index.html">2022.2</a></li>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/vck190-ethernet-trd/2022.1/build/html/index.html">2022.1</a></li>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/vck190-ethernet-trd/2021.2/build/html/index.html">2021.2</a></li>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/vck190-ethernet-trd/2021.1/build/html/index.html">2021.1</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: black" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">VCK190 Ethernet TRD</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../platform_landing.html">MRMAC Ethernet TRD</a> &raquo;</li>
      <li>IEEE 1588 PTP Phase synchronization Platform</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/docs/platform/docs/phase_sync_deployment.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <table class="sphinxhide">
 <tr>
   <td align="center"><img src="https://raw.githubusercontent.com/Xilinx/Image-Collateral/main/xilinx-logo.png" width="30%"/><h1> Versal Prime - VCK190 Evaluation Kit Ethernet TRD Tutorial</h1>
   </td>
 </tr>
 <tr>
 <td align="center"><h1>PTP Phase Syncronization Application Deployment</h1> </td>
 </tr>
</table><section id="ieee-1588-ptp-phase-synchronization-platform">
<h1>IEEE 1588 PTP Phase synchronization Platform<a class="headerlink" href="#ieee-1588-ptp-phase-synchronization-platform" title="Link to this heading">¶</a></h1>
<blockquote>
<div><p><strong>Note:</strong> This section applies to 2022.2 Phase Synchronization TRD only.</p>
</div></blockquote>
<p>This IEEE 1588 PTP Ethernet platform demonstrates the functionality of the Multi Rate Media Access Control (MRMAC) IP  to synchronize time, frequency, and phase of the Physical Hardware clocks (PHC) connected to a packet network that support IEEE 1588 Precision Time Protocol (PTP) protocol. The PHC of the VCK 190 board is synchronized to the PHC of the link partner that supports telecom profile (an another VCK 190 Board in this case) using PTP packets.</p>
<section id="features">
<h2><strong>Features</strong><a class="headerlink" href="#features" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>4x25G configuration</p></li>
<li><p>2-step PTP Phase/Frequency Synchronization</p></li>
<li><p>PTP packet over IEEEE 802.3</p></li>
<li><p>PTP packet over UDP IPV4</p></li>
<li><p>Supports TCP/UDP Traffic</p></li>
</ul>
</section>
<section id="setup-tested">
<h2><strong>Setup Tested</strong><a class="headerlink" href="#setup-tested" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>VCK 190 Board &lt;-&gt; VCK 190 Board</p></li>
</ul>
<section id="application-deployment">
<h3>Application Deployment<a class="headerlink" href="#application-deployment" title="Link to this heading">¶</a></h3>
<p>The steps to deploy and run the PTP Phase synchronization application between two vck190 board using is described below.</p>
</section>
<section id="flash-the-sd-card">
<h3>Flash the SD Card<a class="headerlink" href="#flash-the-sd-card" title="Link to this heading">¶</a></h3>
<ol>
<li><p>Download the 2022.2 Pre-Built Package from <a href="https://github.com/Xilinx/vck190-ethernet-trd">TRD Home Page </a> , unzip and save it on your computer. .</p></li>
<li><p>Navigate to the directory containing the prebuilt images <code class="docutils literal notranslate"><span class="pre">../vck190_ethernet_trd_prebuilt_2022.2</span></code></p></li>
<li><p>Connect the microSD to your computer.</p></li>
<li><p>Prepare the SD card. There are many options to format the SD Card in the windows tool. But, always format with FAT32 option. Use the SD Card Formatter tool to format the SD card <a href="https://www.sdcard.org/downloads/formatter_4/">SD Card Formatter </a></p>
<p><img alt="formatter" src="../../../_images/sd-card-format.png" />.</p>
</li>
<li><p>Copy <code class="docutils literal notranslate"><span class="pre">BOOT.BIN</span> <span class="pre">,</span> <span class="pre">rootfs.cpio.gz.uboot</span> <span class="pre">,</span> <span class="pre">Image</span> <span class="pre">and</span> <span class="pre">boot.scr</span></code> to microSD card.</p></li>
<li><p>Eject the SD card from your computer.</p></li>
<li><p>Connect the microSD card to the Board.</p></li>
<li><p>Repeat steps 2 , 3 , 4 , 5 , 6 for the second Board.</p></li>
</ol>
</section>
<section id="sd-boot-mode">
<h3>SD Boot mode:<a class="headerlink" href="#sd-boot-mode" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Power on the board in SD boot mode.</p></li>
</ul>
</section>
<section id="gt-reference-clocks">
<h3>GT Reference clocks<a class="headerlink" href="#gt-reference-clocks" title="Link to this heading">¶</a></h3>
<p>The GT Reference clocks required for the design are configured by the Renesas IDT drivers.</p>
<blockquote>
<div><ul class="simple">
<li><p>Note: Board UI is not required in the 2022.2 release.</p></li>
</ul>
</div></blockquote>
</section>
<section id="run-host-and-vck190-applications">
<h3>Run Host and VCK190 applications<a class="headerlink" href="#run-host-and-vck190-applications" title="Link to this heading">¶</a></h3>
<p>Once the VCK190 boards are booted, set up an IP address for each ethernet port and make sure the Ethernet link is established using ping. Do not proceed until you are able to ping each interface.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span><span class="n">ifconfig</span> <span class="o">&lt;</span><span class="n">interface_name</span><span class="o">&gt;</span> <span class="n">down</span>	
<span class="o">&gt;</span><span class="n">ifconfig</span> <span class="o">&lt;</span><span class="n">interface_name</span><span class="o">&gt;</span> <span class="n">up</span>
</pre></div>
</div>
<blockquote>
<div><ul class="simple">
<li><p>Note: While making the interface up, make sure a valid IP address is set for the interface.</p></li>
</ul>
</div></blockquote>
</section>
</section>
<section id="ptp-commands">
<h2>PTP commands<a class="headerlink" href="#ptp-commands" title="Link to this heading">¶</a></h2>
<section id="phase-synchronization">
<h3>Phase Synchronization<a class="headerlink" href="#phase-synchronization" title="Link to this heading">¶</a></h3>
<p><strong>Master:</strong></p>
<ul class="simple">
<li><p>Run ptp4l in master mode:</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="n">Board</span><span class="o">-</span><span class="mi">1</span> <span class="o">&gt;</span> <span class="n">ptp4l</span> <span class="o">-</span><span class="n">i</span> <span class="o">&lt;</span><span class="n">interface</span><span class="o">-</span><span class="n">name</span><span class="o">&gt;</span> <span class="o">-</span><span class="n">f</span>  <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">linkpartner_G</span><span class="mf">.8275.1</span><span class="o">.</span><span class="n">cfg</span> <span class="o">-</span><span class="n">m</span>
</pre></div>
</div>
<p><strong>ptp4l master side log</strong> :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="n">ptp4l</span><span class="p">[</span><span class="mf">422.355</span><span class="p">]:</span> <span class="n">selected</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">ptp1</span> <span class="k">as</span> <span class="n">PTP</span> <span class="n">clock</span>
 <span class="n">xilinx</span><span class="o">-</span><span class="n">zcu670</span><span class="o">-</span><span class="mi">20222</span><span class="p">:</span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">petalinux</span><span class="c1"># ptp4l[422.392]: port 1: INITIALIZING to LISTENING on INIT_COMPLETE</span>
 <span class="n">ptp4l</span><span class="p">[</span><span class="mf">422.392</span><span class="p">]:</span> <span class="n">port</span> <span class="mi">0</span><span class="p">:</span> <span class="n">INITIALIZING</span> <span class="n">to</span> <span class="n">LISTENING</span> <span class="n">on</span> <span class="n">INIT_COMPLETE</span>
 <span class="n">ptp4l</span><span class="p">[</span><span class="mf">422.817</span><span class="p">]:</span> <span class="n">port</span> <span class="mi">1</span><span class="p">:</span> <span class="n">LISTENING</span> <span class="n">to</span> <span class="n">MASTER</span> <span class="n">on</span> <span class="n">ANNOUNCE_RECEIPT_TIMEOUT_EXPIRES</span>
 <span class="n">ptp4l</span><span class="p">[</span><span class="mf">422.817</span><span class="p">]:</span> <span class="n">selected</span> <span class="n">local</span> <span class="n">clock</span> <span class="mi">9</span><span class="n">a11bc</span><span class="o">.</span><span class="n">fffe</span><span class="mf">.62</span><span class="n">d209</span> <span class="k">as</span> <span class="n">best</span> <span class="n">master</span>
 <span class="n">ptp4l</span><span class="p">[</span><span class="mf">422.817</span><span class="p">]:</span> <span class="n">port</span> <span class="mi">1</span><span class="p">:</span> <span class="n">assuming</span> <span class="n">the</span> <span class="n">grand</span> <span class="n">master</span> <span class="n">role</span>
</pre></div>
</div>
<p><strong>Slave:</strong></p>
<ul class="simple">
<li><p>Run ts2phc between Renesas ClockMatrix PHC and Xilinx Timer-Syncer PHC in background:</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="n">Board</span><span class="o">-</span><span class="mi">2</span> <span class="o">&gt;</span> <span class="n">ts2phc</span> <span class="o">-</span><span class="n">m</span> <span class="o">-</span><span class="n">c</span> <span class="o">&lt;</span><span class="n">interface</span><span class="o">-</span><span class="n">name</span><span class="o">&gt;</span> <span class="o">-</span><span class="n">s</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">ptp0</span> <span class="o">-</span><span class="n">f</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">ts2phc</span><span class="o">.</span><span class="n">cfg</span> <span class="o">&amp;</span>
</pre></div>
</div>
<p><strong>ts2phc log</strong> :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="n">PTP_PIN_SETFUNC2</span> <span class="n">failed</span><span class="p">:</span> <span class="n">Invalid</span> <span class="n">argument</span>
 <span class="n">ts2phc</span><span class="p">[</span><span class="mf">521.912</span><span class="p">]:</span> <span class="n">Failed</span> <span class="n">to</span> <span class="nb">set</span> <span class="n">the</span> <span class="n">pin</span><span class="o">.</span> <span class="n">Continuing</span> <span class="n">bravely</span> <span class="n">on</span><span class="o">...</span>
</pre></div>
</div>
<blockquote>
<div><ul class="simple">
<li><p><strong>Note: This message can be ignored because the Renesas ClockMatrix PHC driver does not support dynamic PTP_PIN_SETFUNC. For more details refer <a class="reference external" href="https://www.renesas.com/us/en/document/mas/linux-ptp-using-phc-adjust-phase-quick-start-manual">Renesas Phase Adjust quick start manual</a> or Use -l option.</strong></p></li>
</ul>
</div></blockquote>
<ul class="simple">
<li><p>Run ptp4l in slave mode:</p></li>
</ul>
<blockquote>
<div><ul class="simple">
<li><p>Note: Ensure that only one instance of ptp4l master is running in Link partner.</p></li>
</ul>
</div></blockquote>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="n">Board</span><span class="o">-</span><span class="mi">2</span> <span class="o">&gt;</span> <span class="n">ptp4l</span> <span class="o">-</span><span class="n">m</span> <span class="o">-</span><span class="n">q</span> <span class="o">-</span><span class="n">p</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">ptp0</span> <span class="o">-</span><span class="n">s</span> <span class="o">-</span><span class="n">f</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">standalone_G</span><span class="mf">.8275.1</span><span class="o">.</span><span class="n">cfg</span>
</pre></div>
</div>
<p><strong>ptp4l phase synchronization log</strong> :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="n">ptp4l</span><span class="p">[</span><span class="mf">530.543</span><span class="p">]:</span> <span class="n">selected</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">ptp0</span> <span class="k">as</span> <span class="n">PTP</span> <span class="n">clock</span>
 <span class="n">ptp4l</span><span class="p">[</span><span class="mf">530.546</span><span class="p">]:</span> <span class="n">port</span> <span class="mi">1</span><span class="p">:</span> <span class="n">taking</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">ptp0</span> <span class="kn">from</span> <span class="nn">the</span> <span class="n">command</span> <span class="n">line</span><span class="p">,</span> <span class="ow">not</span> <span class="n">the</span> <span class="n">attached</span> <span class="n">ptp1</span>
 <span class="n">xilinx</span><span class="o">-</span><span class="n">zcu670</span><span class="o">-</span><span class="mi">20222</span><span class="p">:</span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">petalinux</span><span class="c1"># ptp4l[530.588]: port 1: INITIALIZING to LISTENING on INIT_COMPLETE</span>
 <span class="n">ptp4l</span><span class="p">[</span><span class="mf">530.588</span><span class="p">]:</span> <span class="n">port</span> <span class="mi">0</span><span class="p">:</span> <span class="n">INITIALIZING</span> <span class="n">to</span> <span class="n">LISTENING</span> <span class="n">on</span> <span class="n">INIT_COMPLETE</span>
 <span class="n">ptp4l</span><span class="p">[</span><span class="mf">530.673</span><span class="p">]:</span> <span class="n">port</span> <span class="mi">1</span><span class="p">:</span> <span class="n">new</span> <span class="n">foreign</span> <span class="n">master</span> <span class="mi">9</span><span class="n">a11bc</span><span class="o">.</span><span class="n">fffe</span><span class="mf">.62</span><span class="n">d209</span><span class="o">-</span><span class="mi">1</span>
 <span class="n">ptp4l</span><span class="p">[</span><span class="mf">530.923</span><span class="p">]:</span> <span class="n">selected</span> <span class="n">best</span> <span class="n">master</span> <span class="n">clock</span> <span class="mi">9</span><span class="n">a11bc</span><span class="o">.</span><span class="n">fffe</span><span class="mf">.62</span><span class="n">d209</span>
 <span class="n">ptp4l</span><span class="p">[</span><span class="mf">530.923</span><span class="p">]:</span> <span class="n">port</span> <span class="mi">1</span><span class="p">:</span> <span class="n">LISTENING</span> <span class="n">to</span> <span class="n">UNCALIBRATED</span> <span class="n">on</span> <span class="n">RS_SLAVE</span>
 <span class="n">ptp4l</span><span class="p">[</span><span class="mf">531.303</span><span class="p">]:</span> <span class="n">port</span> <span class="mi">1</span><span class="p">:</span> <span class="n">UNCALIBRATED</span> <span class="n">to</span> <span class="n">SLAVE</span> <span class="n">on</span> <span class="n">MASTER_CLOCK_SELECTED</span>
 <span class="n">ptp4l</span><span class="p">[</span><span class="mf">531.990</span><span class="p">]:</span> <span class="n">rms</span> <span class="mi">937470829990502912</span> <span class="nb">max</span> <span class="mi">1676998802225530368</span> <span class="n">freq</span>  <span class="o">-</span><span class="mi">1588</span> <span class="o">+/-</span> <span class="mi">63277</span> <span class="n">delay</span> <span class="o">-</span><span class="mi">59892814365198016</span> <span class="o">+/-</span> <span class="mi">215946613225567776</span>
 <span class="n">ptp4l</span><span class="p">[</span><span class="mf">532.991</span><span class="p">]:</span> <span class="n">rms</span> <span class="mi">2629</span> <span class="nb">max</span> <span class="mi">3787</span> <span class="n">freq</span>  <span class="o">+</span><span class="mi">5008</span> <span class="o">+/-</span> <span class="mi">3793</span> <span class="n">delay</span>   <span class="mi">167</span> <span class="o">+/-</span>  <span class="mi">94</span>
 <span class="n">ptp4l</span><span class="p">[</span><span class="mf">533.991</span><span class="p">]:</span> <span class="n">rms</span> <span class="mi">3208</span> <span class="nb">max</span> <span class="mi">3803</span> <span class="n">freq</span>  <span class="o">-</span><span class="mi">2030</span> <span class="o">+/-</span> <span class="mi">660</span> <span class="n">delay</span>    <span class="mi">52</span> <span class="o">+/-</span>  <span class="mi">19</span>
 <span class="n">ptp4l</span><span class="p">[</span><span class="mf">534.991</span><span class="p">]:</span> <span class="n">rms</span> <span class="mi">1209</span> <span class="nb">max</span> <span class="mi">2025</span> <span class="n">freq</span>  <span class="o">-</span><span class="mi">1957</span> <span class="o">+/-</span> <span class="mi">389</span> <span class="n">delay</span>    <span class="mi">52</span> <span class="o">+/-</span>  <span class="mi">17</span>
 <span class="n">ptp4l</span><span class="p">[</span><span class="mf">535.991</span><span class="p">]:</span> <span class="n">rms</span>  <span class="mi">169</span> <span class="nb">max</span>  <span class="mi">270</span> <span class="n">freq</span>   <span class="o">-</span><span class="mi">687</span> <span class="o">+/-</span> <span class="mi">290</span> <span class="n">delay</span>    <span class="mi">66</span> <span class="o">+/-</span>   <span class="mi">6</span>
 <span class="n">ptp4l</span><span class="p">[</span><span class="mf">536.992</span><span class="p">]:</span> <span class="n">rms</span>  <span class="mi">226</span> <span class="nb">max</span>  <span class="mi">255</span> <span class="n">freq</span>   <span class="o">-</span><span class="mi">112</span> <span class="o">+/-</span>  <span class="mi">63</span> <span class="n">delay</span>    <span class="mi">74</span> <span class="o">+/-</span>   <span class="mi">2</span>
 <span class="n">ptp4l</span><span class="p">[</span><span class="mf">537.992</span><span class="p">]:</span> <span class="n">rms</span>   <span class="mi">99</span> <span class="nb">max</span>  <span class="mi">159</span> <span class="n">freq</span>    <span class="o">-</span><span class="mi">78</span> <span class="o">+/-</span>  <span class="mi">23</span> <span class="n">delay</span>    <span class="mi">75</span> <span class="o">+/-</span>   <span class="mi">2</span>
 <span class="n">ptp4l</span><span class="p">[</span><span class="mf">538.992</span><span class="p">]:</span> <span class="n">rms</span>   <span class="mi">13</span> <span class="nb">max</span>   <span class="mi">30</span> <span class="n">freq</span>   <span class="o">-</span><span class="mi">166</span> <span class="o">+/-</span>  <span class="mi">22</span> <span class="n">delay</span>    <span class="mi">74</span> <span class="o">+/-</span>   <span class="mi">1</span>
 <span class="n">ptp4l</span><span class="p">[</span><span class="mf">539.993</span><span class="p">]:</span> <span class="n">rms</span>   <span class="mi">16</span> <span class="nb">max</span>   <span class="mi">18</span> <span class="n">freq</span>   <span class="o">-</span><span class="mi">211</span> <span class="o">+/-</span>   <span class="mi">6</span> <span class="n">delay</span>    <span class="mi">73</span> <span class="o">+/-</span>   <span class="mi">1</span>
 <span class="n">ptp4l</span><span class="p">[</span><span class="mf">540.993</span><span class="p">]:</span> <span class="n">rms</span>    <span class="mi">8</span> <span class="nb">max</span>   <span class="mi">12</span> <span class="n">freq</span>   <span class="o">-</span><span class="mi">217</span> <span class="o">+/-</span>   <span class="mi">1</span> <span class="n">delay</span>    <span class="mi">73</span> <span class="o">+/-</span>   <span class="mi">0</span>
 <span class="n">ptp4l</span><span class="p">[</span><span class="mf">541.993</span><span class="p">]:</span> <span class="n">rms</span>    <span class="mi">1</span> <span class="nb">max</span>    <span class="mi">2</span> <span class="n">freq</span>    <span class="o">-</span><span class="mi">13</span> <span class="o">+/-</span>  <span class="mi">51</span> <span class="n">delay</span>    <span class="mi">73</span> <span class="o">+/-</span>   <span class="mi">0</span>
</pre></div>
</div>
<blockquote>
<div><ul class="simple">
<li><p><strong>Note: Before running frequency syncronization kill all instance of ts2phc running background.</strong></p></li>
</ul>
</div></blockquote>
</section>
<section id="trd-package">
<h3>TRD Package<a class="headerlink" href="#trd-package" title="Link to this heading">¶</a></h3>
</section>
</section>
<section id="accessing-the-tutorial-reference-files">
<h2>Accessing the Tutorial Reference Files<a class="headerlink" href="#accessing-the-tutorial-reference-files" title="Link to this heading">¶</a></h2>
<ol class="simple">
<li><p>Download the 2022.2 Source Files from <a href="https://github.com/Xilinx/vck190-ethernet-trd">TRD Home Page </a> .</p></li>
<li><p>Unzip the TRD package.</p></li>
<li><p>Navigate to the <code class="docutils literal notranslate"><span class="pre">../vck190-ethernet-trd-2022.2</span></code> which is the working directory.</p></li>
</ol>
</section>
<section id="trd-package-file-structure">
<h2>TRD package File Structure:<a class="headerlink" href="#trd-package-file-structure" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>The TRD package file hierarchy is shown in the below snapshot.</p></li>
</ul>
<p><img alt="trd_package" src="../../../_images/vck_190_file_hier.PNG" /></p>
<p>The TRD package contains:</p>
<ol class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Makefile</span></code> has scripts to build the entire TRD package hardware and software platforms in a single run.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">README.md</span></code> README.md contains the documentation.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">vivado</span></code> folder contains files to create the vck190 ethernet hardware platform.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">petalinux</span></code> folder contains files to build the petalinux images.</p></li>
</ol>
<section id="build-flow">
<h3>Build Flow<a class="headerlink" href="#build-flow" title="Link to this heading">¶</a></h3>
<p>This tutorial shows how to build the TRD package.</p>
</section>
<section id="prerequisites">
<h3>Prerequisites<a class="headerlink" href="#prerequisites" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Vivado Design Suite 2022.2</p></li>
<li><p>PetaLinux 2022.2 tools</p></li>
</ul>
</section>
</section>
<section id="to-build-the-trd-package-with-the-top-makefile">
<h2>To Build the TRD Package with the top Makefile:<a class="headerlink" href="#to-build-the-trd-package-with-the-top-makefile" title="Link to this heading">¶</a></h2>
<p>Running the <code class="docutils literal notranslate"><span class="pre">../vck190-ethernet-trd-2022.2/Makefile</span></code> will generate the hardware platform XSA and subsequently the petalinux images.</p>
<ol>
<li><p>Go to the working directory</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">vck190</span><span class="o">-</span><span class="n">ethernet</span><span class="o">-</span><span class="n">trd</span><span class="o">-</span><span class="mf">2022.2</span>
</pre></div>
</div>
</li>
<li><p>Run the following command to build and generate sdcard wic image. This Makefile calls lower level Makefiles to build hardware XSA and petalinux images. The XSA generation may take couple of hours depending on the system specification.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">make</span> <span class="n">sdcard</span> <span class="n">YES</span><span class="o">=</span><span class="mi">1</span>   
</pre></div>
</div>
</li>
</ol>
</section>
<section id="to-build-the-hardware-platform-xsa">
<h2>To Build the Hardware Platform XSA:<a class="headerlink" href="#to-build-the-hardware-platform-xsa" title="Link to this heading">¶</a></h2>
<p>This tutorial shows how to build XSA alone using the makefiles</p>
<ul class="simple">
<li><p>Generate XSA using <code class="docutils literal notranslate"><span class="pre">../vck190-ethernet-trd-2022.2/vivado/Makefile</span></code></p></li>
</ul>
<ol>
<li><p>Go to the platform directory specific to the application</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">vck190</span><span class="o">-</span><span class="n">ethernet</span><span class="o">-</span><span class="n">trd</span><span class="o">-</span><span class="mf">2022.2</span><span class="o">/</span><span class="n">vivado</span><span class="o">/</span>
</pre></div>
</div>
</li>
<li><p>To build the XSA, Source Vivado and run the following command. The Makefile uses scripts/main.tcl file to create a Vivado project, populate the block design and finally build a XSA. The XSA generation may take couple of hours depending on the system specification</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">make</span> <span class="n">design_xsa</span>   
</pre></div>
</div>
</li>
<li><p>The generated XSA will be located at:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">../</span><span class="n">vivado</span><span class="o">/</span><span class="n">vck190_ethernet_platform</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">mrmac_subsys_wrapper</span><span class="o">.</span><span class="n">xsa</span>
</pre></div>
</div>
</section>
<section id="to-build-the-petalinux-images">
<h2>To Build the Petalinux Images:<a class="headerlink" href="#to-build-the-petalinux-images" title="Link to this heading">¶</a></h2>
<p>In the following sections, the steps to build petalinux images are given.</p>
<p>Follow the steps below to build petalinux images using the Makefile in <strong>../vck190-ethernet-trd-2022.2/petalinux/xilinx-vck190-trd</strong> path.</p>
<ol>
<li><p>Go to the petalinux BSP folder.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">../</span><span class="n">vck190</span><span class="o">-</span><span class="n">ethernet</span><span class="o">-</span><span class="n">trd</span><span class="o">-</span><span class="mf">2022.2</span><span class="o">/</span><span class="n">petalinux</span><span class="o">/</span><span class="n">xilinx</span><span class="o">-</span><span class="n">vck190</span><span class="o">-</span><span class="n">trd</span>
</pre></div>
</div>
</li>
<li><p>To build boot images, source petalinux tool and run the following command.</p>
<p>The Makefile configures the hardware platform required to build the petalinux images and create BOOT.BIN, which comprise of  FSBL, UBoot, PMU firmware and hardware bit file.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">make</span> <span class="n">boot</span>
</pre></div>
</div>
</li>
<li><p>The generated images will be located at:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">../</span><span class="n">vck190</span><span class="o">-</span><span class="n">ethernet</span><span class="o">-</span><span class="n">trd</span><span class="o">-</span><span class="mf">2022.2</span><span class="o">/</span><span class="n">petalinux</span><span class="o">/</span><span class="n">xilinx</span><span class="o">-</span><span class="n">vck190</span><span class="o">-</span><span class="n">trd</span><span class="o">/</span><span class="n">images</span><span class="o">/</span><span class="n">linux</span>
</pre></div>
</div>
</li>
<li><p>Copy the image (<code class="docutils literal notranslate"><span class="pre">BOOT.BIN</span> <span class="pre">,</span> <span class="pre">rootfs.cpio.gz.uboot</span> <span class="pre">,</span> <span class="pre">Image</span> <span class="pre">and</span> <span class="pre">boot.scr</span></code> ) to the FAT32 formatted SD card and insert the card in SD card slot to run the design. This image is functionally equivalent to the prebuilt sdcard image provided with package.</p></li>
</ol>
<section id="next-steps">
<h3>Next Steps<a class="headerlink" href="#next-steps" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>To read about PPS Phase sync, go to the <a class="reference internal" href="sw_arch_platform.html"><span class="doc">SW Architecture Platform page</span></a></p></li>
<li><p>Go back to the <a class="reference internal" href="../platform_landing.html"><span class="doc">VCK190 Ethernet TRD design start page</span></a></p></li>
</ul>
</section>
</section>
<section id="license">
<h2>License<a class="headerlink" href="#license" title="Link to this heading">¶</a></h2>
<p>Licensed under the Apache License, Version 2.0 (the “License”); you may not use this file except in compliance with the License.</p>
<p>You may obtain a copy of the License at
<a class="reference external" href="http://www.apache.org/licenses/LICENSE-2.0">http://www.apache.org/licenses/LICENSE-2.0</a></p>
<p>Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an “AS IS” BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License.</p>
<p align="center">Copyright&copy; 2022 Xilinx</p></section>
</section>


           </div>
          </div>
          
                  <style>
                        .footer {
                        position: fixed;
                        left: 0;
                        bottom: 0;
                        width: 100%;
                        }
                  </style>
				  
				  <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="revision_history.html" class="btn btn-neutral float-left" title="Revision History" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="vmk_180_porting.html" class="btn btn-neutral float-right" title="Steps to Build the TRD Package for VMK180 Board" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022-2023, Xilinx, Inc. Xilinx is now a part of AMD.
      <span class="lastupdated">Last updated on March 14, 2024.
      </span></p>
  </div>



										<div class="aem-Grid aem-Grid--16">
											<div class="aem-GridColumn aem-GridColumn--xxxlarge--none aem-GridColumn--xsmall--16 aem-GridColumn--offset--xsmall--0 aem-GridColumn--xlarge--none aem-GridColumn--xxlarge--none aem-GridColumn--default--none aem-GridColumn--offset--large--1 aem-GridColumn--xlarge--12 aem-GridColumn--offset--default--0 aem-GridColumn--xxlarge--10 aem-GridColumn--offset--xlarge--2 aem-GridColumn--offset--xxlarge--3 aem-GridColumn--offset--xxxlarge--4 aem-GridColumn--xsmall--none aem-GridColumn--large--none aem-GridColumn aem-GridColumn--large--14 aem-GridColumn--xxxlarge--8 aem-GridColumn--default--16">
												<div class="container-fluid sub-footer">

													                    <div class="row">
                        <div class="col-xs-24">
                          <p><a target="_blank" href="https://www.amd.com/en/corporate/copyright">Terms and Conditions</a> | <a target="_blank" href="https://www.amd.com/en/corporate/privacy">Privacy</a> | <a target="_blank" href="https://www.amd.com/en/corporate/cookies">Cookie Policy</a> | <a target="_blank" href="https://www.amd.com/en/corporate/trademarks">Trademarks</a> | <a target="_blank" href="https://www.amd.com/system/files/documents/statement-human-trafficking-forced-labor.pdf">Statement on Forced Labor</a> | <a target="_blank" href="https://www.amd.com/en/corporate/competition">Fair and Open Competition</a> | <a target="_blank" href="https://www.amd.com/system/files/documents/amd-uk-tax-strategy.pdf">UK Tax Strategy</a> | <a target="_blank" href="https://docs.xilinx.com/v/u/9x6YvZKuWyhJId7y7RQQKA">Inclusive Terminology</a> | <a href="https://pages.gitenterprise.xilinx.com/techdocs/Test/vvas/build/html/index.html#cookiessettings" class="ot-sdk-show-settings">Cookies Settings</a></p>
                        </div>
                    </div>
												</div>
											</div>
										</div>
										
</br>


  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header").click(function() {
            $(this).parent().children().not(".header").toggle(400);
            $(this).parent().children(".header").toggleClass("open");
        })
    });
</script>


</body>
</html>